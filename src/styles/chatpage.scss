[data-theme="light"]{--bg-color:#f0f2f5;--bg-light:#ffffff;--primary-color:#0084ff;--text-color:#1c1e21;--text-subtle:#65676b;--border-color:#e4e6eb;--dots-color:#ffffff}
[data-theme="dark"]{--bg-color:#1a1a2e;--bg-light:#202030;--primary-color:#9d5fe5;--text-color:#e0e0e0;--text-subtle:#a0a0b0;--border-color:#3b3b50;--dots-color:#ffffff}

.chat-page{display:flex;height:100vh;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Oxygen-Sans",Ubuntu,Cantarell,"Helvetica Neue",sans-serif;background-color:var(--bg-color);color:var(--text-color);overflow:hidden;transition:background-color .3s,color .3s}
.chat-left{flex-shrink:0;width:320px;background-color:var(--bg-light);border-right:1px solid var(--border-color);display:flex;flex-direction:column;padding:16px;box-shadow:0 0 10px rgba(0,0,0,.05)}
.chat-left .auth-area{padding:8px;margin-bottom:20px;display:flex;align-items:center}
.chat-left .me{display:flex;align-items:center;gap:12px}
.chat-left img{width:50px;height:50px;border-radius:50%;object-fit:cover;cursor:pointer}
.chat-left .name{font-weight:600}
.chat-left .email{font-size:12px;color:var(--text-subtle)}
.search-area{margin-bottom:20px}
.search-area input{width:100%;padding:10px 15px;border:1px solid var(--border-color);border-radius:20px;font-size:14px;transition:all .2s;background-color:var(--bg-color);color:var(--text-color)}
.search-area input::placeholder{color:var(--text-subtle)}
.search-area input:focus{outline:none;border-color:var(--primary-color)}
.search-results{margin-top:10px;background-color:var(--bg-light);border-radius:8px;box-shadow:0 2px 10px rgba(0,0,0,.1);border:1px solid var(--border-color)}
.search-results .no-results{padding:10px;color:var(--text-subtle)}
.search-item{display:flex;align-items:center;padding:10px;cursor:pointer;border-bottom:1px solid var(--border-color)}
.search-item:last-child{border-bottom:none}
.search-item:hover{background-color:var(--bg-color)}
.search-item img{width:40px;height:40px;border-radius:50%;margin-right:10px;object-fit:cover}
.search-item .meta .name{font-weight:600}
.search-item .meta .email{font-size:12px;color:var(--text-subtle)}
.chats-section{margin-top:10px}
.chats-section h4{margin:0;padding:0 8px}
.chat-list{flex:1;overflow-y:auto}
.chat-list .no-chats{color:#777;padding:8px}
.chat-row{display:flex;align-items:center;padding:15px;margin-bottom:8px;cursor:pointer;border-radius:10px;transition:background-color .2s}
.chat-row:hover{background-color:var(--border-color)}
.chat-row.active{background-color:var(--primary-color);color:white}
.chat-row.active .title{color:white}
.chat-row.active .last,.chat-row.active .right{color:rgba(255,255,255,.8)}
.avatar-wrapper{position:relative;margin-right:15px}
.presence-container{position:relative}
.presence-container img{width:44px;height:44px;border-radius:8px;object-fit:cover}
.avatar-placeholder{width:44px;height:44px;border-radius:8px;background-color:var(--border-color);display:flex;align-items:center;justify-content:center;font-weight:bold;font-size:1.2em;color:var(--text-subtle)}
.center{flex-grow:1;overflow:hidden}
.title{font-weight:600;font-size:16px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.last{font-size:14px;color:var(--text-subtle);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.right{font-size:12px;color:var(--text-subtle);white-space:nowrap}
.chat-right{flex:1;display:flex;flex-direction:column;background-color:var(--bg-color)}
.placeholder{display:flex;justify-content:center;align-items:center;height:100%;color:var(--text-subtle);font-size:18px;font-weight:500}
.chat-window{display:flex;flex-direction:column;height:100%}
.chat-window-header{padding:12px 14px;background-color:var(--bg-light);border-bottom:1px solid var(--border-color);display:flex;align-items:center;gap:12px}
.header-info{display:flex;gap:12px;width: 100%; align-items:center;cursor:pointer}
.chat-window-header img{width:44px;height:44px;border-radius:8px;object-fit:cover}
.chat-window-header .title{font-size:16px;font-weight:600;color:var(--text-color)}
.chat-window-header .subtitle{font-size:12px;color:var(--text-subtle)}
.back-btn{background:transparent;border:none;color:var(--primary-color);font-weight:600;padding:6px 10px;border-radius:8px}
.header-actions{position:relative}
.dots-btn{background:transparent;border:none;font-size:20px;cursor:pointer;color:var(--dots-color);padding:6px}
.header-menu{position:absolute;right:0;top:36px;background:var(--bg-light);border:1px solid var(--border-color);padding:6px;border-radius:8px;box-shadow:0 10px 30px rgba(0,0,0,0.12)}
.header-menu button{background:transparent;border:none;padding:8px 12px;width:100%;text-align:left;cursor:pointer;color:var(--text-color)}
.messages-area{flex:1;padding:18px 16px 140px 16px;overflow-y:auto;display:flex;flex-direction:column;gap:12px}
.message{padding:12px;border-radius:20px;max-width:70%;position:relative;color:var(--text-color)}
.message.mine{background-color:var(--primary-color);color:white;align-self:flex-end;border-bottom-right-radius:5px}
.message.their{background-color:var(--bg-light);align-self:flex-start;border-bottom-left-radius:5px;box-shadow:0 1px 2px rgba(0,0,0,.06)}
.message-row{display:flex;align-items:flex-end;gap:8px}
.message-body{display:flex;flex-direction:column}
.message-text{white-space:pre-wrap}
.msg-actions{display:flex;flex-direction:column;align-items:center;gap:6px;opacity:0;transform:translateX(8px);transition:opacity .18s ease,transform .18s ease}
.message:hover .msg-actions{opacity:1;transform:translateX(0)}
.pencil-btn{background:transparent;border:none;cursor:pointer;font-size:18px;padding:6px;color:var(--text-subtle);border-radius:8px}
.pencil-btn:hover{background:rgba(0,0,0,0.04);color:var(--text-color)}
.trash-btn{background:transparent;border:none;cursor:pointer;font-size:16px;padding:6px;color:var(--text-subtle);border-radius:8px}
.trash-btn:hover{background:rgba(0,0,0,0.04);color:var(--text-color)}
.msg-menu{position:relative;margin-top:6px;background:var(--bg-light);border:1px solid var(--border-color);padding:6px;border-radius:8px;box-shadow:0 8px 24px rgba(0,0,0,0.12)}
.message .message-media{margin-top:8px}
.message .message-media img{max-width:100%;border-radius:8px}
.message .meta{text-align:right;font-size:11px;color:var(--text-subtle);margin-top:6px}
.composer{padding:12px 16px;background-color:var(--bg-light);border-top:1px solid var(--border-color);display:flex;align-items:center;gap:10px}
.input-wrap{flex:1;position:relative}
.input-wrap input{width:100%;padding:12px 16px;border:1px solid var(--border-color);border-radius:999px;font-size:15px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.02));box-shadow:0 2px 8px rgba(2,6,23,0.06);color:var(--text-color);min-width:0}
.input-wrap input::placeholder{color:var(--text-subtle)}
.input-wrap input:focus{outline:none;border-color:var(--primary-color);box-shadow:0 8px 30px rgba(2,132,255,0.12)}
.input-wrap .emoji-panel{position:absolute;bottom:56px;left:8px}
.emoji-btn.compact{background:transparent;border:none;font-size:20px;cursor:pointer;padding:6px}
.send-btn{flex:0 0 84px;padding:10px 12px;background:var(--primary-color);color:white;border:none;border-radius:12px;box-shadow:0 6px 18px rgba(0,0,0,0.12)}
.emoji-panel{background:var(--bg-light);border:1px solid var(--border-color);padding:8px;border-radius:8px;display:flex;gap:6px;box-shadow:0 6px 20px rgba(0,0,0,.08)}
.emoji-item{background:transparent;border:none;font-size:18px;cursor:pointer}
.presence{width:10px;height:10px;border-radius:50%;position:absolute;top:36px;left:35px;border:2px solid var(--bg-light)}
.presence.online{background:#2ecc71}
.presence.offline{background:#e74c3c}
.btn-edit{cursor:pointer;border:none;width:100px;border-radius:5px;height:30px;text-align:center;align-content:center;background:#2563eb;color:white}
.btn-delete{cursor:pointer;border:none;width:100px;border-radius:5px;height:30px;text-align:center;align-content:center;background:#dc2626;color:white}
.btn-save{cursor:pointer;border:none;width:100px;border-radius:5px;height:30px;text-align:center;align-content:center;background:#16a34a;color:white}
.btn-cancel{cursor:pointer;border:none;width:100px;border-radius:5px;height:30px;text-align:center;align-content:center;background:#6b7280;color:white}
.edit-overlay{position:fixed;left:0;top:0;right:0;bottom:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0.4);z-index:120}
.edit-box{background:var(--bg-light);padding:16px;border-radius:12px;border:1px solid var(--border-color);box-shadow:0 20px 60px rgba(2,6,23,0.2)}
.edit-box textarea{width:320px}
@media (max-width:768px){
  .chat-page{flex-direction:column}
  .chat-left{width:100%;height:100vh;border-right:none;border-bottom:1px solid var(--border-color);box-shadow:none;padding:8px;display:flex;flex-direction:column}
  .chat-right{width:100%;height:100vh}
  .search-area,.auth-area{display:none}
  .mobile-pane{height:100vh}
  .top-row{display:flex;align-items:center;gap:8px;padding:8px 4px}
  .me-compact img{width:38px;height:38px;border-radius:50%}
  .search-wrap{flex:1}
  .search-wrap input{width:100%;padding:10px;border-radius:999px;border:1px solid var(--border-color);background:var(--bg-light);box-shadow:0 10px 30px rgba(2,6,23,0.08)}
  .chat-list{padding-top:8px}
  .chat-window-header{position:sticky;top:0;z-index:30;display:flex;align-items:center;gap:12px;padding:10px 12px;background:var(--bg-light);border-bottom:1px solid var(--border-color)}
  .back-btn{font-size:15px}
  .messages-area{padding:12px 12px 110px 12px}
  .composer{padding:8px 12px;gap:8px;border-top:1px solid var(--border-color)}
  .composer-fixed{position:fixed;left:0;right:0;bottom:0;padding:10px 12px;background:var(--bg-light);z-index:60;border-top:1px solid var(--border-color);display:flex;align-items:center;gap:10px;height:72px}
  .input-wrap input{padding:12px 16px;font-size:16px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.02));border-radius:999px;box-shadow:0 10px 30px rgba(2,6,23,0.08);border:1px solid var(--border-color)}
  .emoji-panel{bottom:88px;left:14px}
  .message{max-width:85%}
  .chat-row{padding:12px;border-radius:12px}
  .send-btn{flex:0 0 76px}
  .msg-actions{opacity:1;transform:none}
}